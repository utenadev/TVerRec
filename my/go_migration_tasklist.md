# Go移植作業タスクリスト

## Phase 1: 基盤構築

### 1.1 プロジェクト構造のセットアップ
- [ ] ディレクトリ構成の作成
  - cmd/tverec/
  - internal/config/
  - internal/downloader/
  - internal/parser/
  - internal/tver/
  - internal/utils/
  - pkg/
  - assets/
  - docs/
- [ ] go.modとgo.sumの初期化
- [ ] 各パッケージの空の.goファイル作成

### 1.2 設定管理機能の実装
- [ ] configパッケージの作成
  - 設定ファイルの読み込み/書き込み機能
  - デフォルト設定値の定義
- [ ] CLIフラグの定義
  - ダウンロードディレクトリ指定
  - 並列ダウンロード数指定
  - ログレベル指定
- [ ] 環境変数との統合

### 1.3 ログとユーティリティの実装
- [ ] utilsパッケージの作成
  - ログ出力機能 (logパッケージ利用)
  - ファイル操作ユーティリティ
  - 日付・時刻処理ユーティリティ

## Phase 2: APIクライアント実装

### 2.1 TVer APIクライアントの実装
- [ ] tverパッケージの作成
- [ ] APIトークン取得機能の実装
  - platform_users/browser/create エンドポイント呼び出し
  - User-AgentとForwardedヘッダーの設定
- [ ] エピソード情報取得機能の実装
  - callEpisode/{episode_id} エンドポイント呼び出し
- [ ] シリーズ情報取得機能の実装
  - callSeriesSeasons/{series_id} エンドポイント呼び出し
- [ ] シーズン情報取得機能の実装
  - callSeasonEpisodes/{season_id} エンドポイント呼び出し
- [ ] APIレスポンスのデータ構造定義

## Phase 3: コア機能実装

### 3.1 動画解析機能の実装
- [ ] parserパッケージの作成
- [ ] URLからコンテンツIDを抽出する機能
  - 正規表現によるエピソードID抽出
  - 正規表現によるシリーズID抽出
- [ ] キーワード検索機能の実装
  - callKeywordSearch エンドポイント呼び出し
- [ ] プレイリスト情報の解析と整理
  - エピソード一覧の取得とソート

### 3.2 ダウンローダー機能の実装
- [ ] downloaderパッケージの作成
- [ ] M3U8プレイリスト解析機能
  - hls.goまたは同様のライブラリの調査・利用
- [ ] 動画フォーマット選択ロジック
  - 最高画質の選択
  - 指定された画質の選択
- [ ] 並列ダウンロード機能
  - goroutineとchannelによる並列処理
- [ ] プログレス表示機能
- [ ] メタデータとサムネイルの保存機能

## Phase 4: CLIアプリケーション実装

### 4.1 メインCLIアプリケーションの実装
- [ ] cmd/tverec/main.goの作成
- [ ] コマンドラインインターフェースの定義
  - ダウンロードコマンド
  - 情報取得コマンド
  - 設定コマンド
- [ ] ユーザー入力の処理
  - URL/キーワードの受け取り
  - オプションパラメータの処理
- [ ] 機能統合
  - parser → tver → downloader の呼び出しフロー
- [ ] ヘルプ表示とエラーハンドリング

## Phase 5: 統合・テスト

### 5.1 統合テストとバグ修正
- [ ] 全体機能の結合テスト
  - エピソード単体ダウンロード
  - シリーズ全話ダウンロード
  - キーワード検索ダウンロード
- [ ] エラーケースのハンドリング改善
  - APIエラー時の処理
  - ネットワークエラー時の処理
  - ファイル書き込みエラー時の処理
- [ ] パフォーマンスとリソース使用量の最適化

### 5.2 ドキュメント整備
- [ ] README.mdの作成
  - インストール方法
  - 使用方法
  - コマンドラインオプション
- [ ] 利用手順書の作成
- [ ] 開発者向けドキュメントの作成

## Phase 6: 将来的な拡張機能 (オプション)

### 6.1 追加機能の実装
- [ ] GUIアプリケーション対応 (Fyneなど)
- [ ] ダウンロード履歴管理と再開機能
- [ ] 複数同時ダウンロードキュー
- [ ] プラグイン機構による機能拡張